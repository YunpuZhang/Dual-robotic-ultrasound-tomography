function gst= ur5FwdKin(q)



L0 = 0.0892;
L1 = 0.425;
L2 = 0.392;
L3 = 0.1093;
L4 = 0.09475;
L5 = 0.0825;


g0 = [ -1 0 0 0.8170;0 0 1 0.1918;0 1 0 -0.0055; 0 0 0 1];
%g0 = [ 0 1 0 0.8180;0 0 1 0.321;1 0 0 -0.004; 0 0 0 1];


w1 = [0;0;1];
q1 = [0;0;0];

w2 = [0;1;0];
q2 = [0;0;L0];

w3 = [0;1;0];
q3 = [L1;0;L0];

w4 = [0;1;0];
q4 = [L1+L2;0;L0];

w5 = [0;0;-1];
q5 = [L1+L2;L3;L0];

w6 = [0;1;0];
q6 = [L1+L2;0;L0-L4];

xi1 = [-cross(w1,q1) ;w1];
xi2 = [-cross(w2,q2) ;w2];
xi3 = [-cross(w3,q3) ;w3];
xi4 = [-cross(w4,q4) ;w4];
xi5 = [-cross(w5,q5) ;w5];
xi6 = [-cross(w6,q6) ;w6];



x1 = [sk(xi1(4:6)) xi1(1:3); 0, 0, 0, 0];
x2 = [sk(xi2(4:6)) xi2(1:3); 0, 0, 0, 0];
x3 = [sk(xi3(4:6)) xi3(1:3); 0, 0, 0, 0];
x4 = [sk(xi4(4:6)) xi4(1:3); 0, 0, 0, 0];
x5 = [sk(xi5(4:6)) xi5(1:3); 0, 0, 0, 0];
x6 = [sk(xi6(4:6)) xi6(1:3); 0, 0, 0, 0];

gst = expm(x1*q(1))*expm(x2*q(2))*expm(x3*q(3))*expm(x4*q(4))*expm(x5*q(5))*expm(x6*q(6))*g0;



end

function skew = sk(x)
x1=x(1);
x2=x(2);
x3=x(3);
skew=[0 -x3 x2; x3 0 -x1; -x2 x1 0];
end


